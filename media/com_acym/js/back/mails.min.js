/**
 * @package    AcyMailing for Joomla
 * @version    6.0.1
 * @author     acyba.com
 * @copyright  (C) 2009-2018 ACYBA S.A.R.L. All rights reserved.
 * @license    GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
 */

jQuery(document).ready(function(t){function a(){var a=AJAX_URL_ACYM+"&page=acymailing_mails&ctrl=mails&task=getTemplateAjax";a+="&search="+t("#acym_search_template_choose__ajax").val(),a+="&tag="+t("#acym_tag_template_choose__ajax").val(),a+="&type="+t("#acym__type-template").val(),a+="&pagination_page_ajax="+t("#acym_pagination__ajax").val(),a+="&editor="+t("#acym__mail__edit__editor").val(),t.post(a,function(a){var i;t(".acym__template__choose__ajax").html(a),i=null,t('input[name="mailchoose_search__ajax"]').off("keyup").on("keyup",function(a){var e=t(this),c=e.val();(c||8==a.which)&&""!=c&&c.length>=2&&(clearTimeout(i),i=setTimeout(function(){t("#acym_search_template_choose__ajax").attr("value",c),_()},1500)),13==a.which&&(clearTimeout(i),t("#acym_search_template_choose__ajax").attr("value",c),_()),8==a.which&&""==e.val()&&(clearTimeout(i),t("#acym_search_template_choose__ajax").attr("value",""),_())}),t("#acym__template__choose__modal .acym__search__button").off("click").on("click",function(a){a.preventDefault(),clearTimeout(i),t("#acym_search_template_choose__ajax").attr("value",t('input[name="mailchoose_search__ajax"]').attr("value")),_()}),t("#mailchoose_tag__ajax").on("change",function(a){t("#acym_tag_template_choose__ajax").attr("value",t(this).attr("value")),_()}),t("#acym__template__choose__modal .acym__type__choosen").off("click").on("click",function(a){a.preventDefault(),t("#acym__type-template").val(t(this).attr("type")),t(".acym__type__choosen").removeClass("is-active"),t(this).addClass("is-active").blur(),_()}),e()})}function _(){t("#acym_pagination__ajax").attr("value",1),a()}function e(){t(".acym__template__choose__ajax .acym__pagination__page__ajax").off("click").on("click",function(_){_.preventDefault(),t("#acym_pagination__ajax").attr("value",t(this).attr("page")),a()})}t(".acym__templates__filter__tags__ajax").select2({theme:"foundation",width:"100%"}),t(".acym__templates__filter__tags").select2({theme:"foundation",width:"100%"}),t("#acym__template__type").select2({theme:"foundation",width:"100%"}),t(".acym__templates__choose__type-templates .button").click(function(){t(this).siblings().removeClass("is-active"),t(this).addClass("is-active")}),_(),e(),function(){if(t("#acym__editor__content").length>0){var a=!1;t(".acym__template__prevent__unload").on("click",function(_){a=!0,function(a){var _=t("#editor_thumbnail"),e=t('[name="thumbnail"]'),i=AJAX_URL_ACYM+"&ctrl=mails&task=setNewThumbnail";if(""===_.val()&&""!==e.val())return _.val(e.val()),void a.click();""!==_.val()&&void 0!==_.val()||t.setThumbnail(),""===e.val()&&""===_.val()?(_.val(""),a.click()):t.ajax({type:"POST",url:i,data:{content:_.val(),thumbnail:e.val()},success:function(t){_.val(t),a.click()}})}(t("#data_"+t(this).attr("id")))}),t(window).on("beforeunload",function(){if(!a)return""})}}(),t('input[name="mailchoose_search__ajax"]').next().off("click").on("click",function(){t('input[name="mailchoose_search__ajax"]').val(""),t("#acym_search_template_choose__ajax").val(""),_()}),t("#acym__template__type").on("change",function(){"standard"!=t(this).val()?t('input[name="mail[subject]"]').attr("required","required"):t('input[name="mail[subject]"]').removeAttr("required")}),t(".acym__create__template").off("click").on("click",function(){t("#acym_create_template_type_editor").val(t(this).attr("data-editor")),t('input[name="task"]').val(t(this).attr("data-task")),t("#formSubmit").click()}),t(".mails_listing").length>0?(t.introContent=[{element:'[data-editor="acyEditor"]',text:ACYM_JS_TXT.ACYM_INTRO_CREATE_DD},{element:'[data-editor="html"]',text:ACYM_JS_TXT.ACYM_INTRO_CREATE_HTML}],t.setIntrojs("mail_listing")):t(".mails_edit").length>0&&(t("#acym__wysid__edit__button").on("click",function(){t.introContent=[{element:"table.body",text:ACYM_JS_TXT.ACYM_INTRO_TEMPLATE},{element:".acym__wysid__right__toolbar__blocks",text:ACYM_JS_TXT.ACYM_INTRO_DRAG_BLOCKS},{element:".acym__wysid__right__toolbar__contents",text:ACYM_JS_TXT.ACYM_INTRO_DRAG_CONTENT},{element:"#acym__wysid__right__toolbar__settings__tab",text:ACYM_JS_TXT.ACYM_INTRO_SETTINGS}],t.setIntrojs("mail_editor_content")}),t("#acym__wysid__right__toolbar__settings__tab").on("click",function(){setTimeout(function(){t.introContent=[{element:".acym__wysid__right__toolbar__design",text:ACYM_JS_TXT.ACYM_INTRO_CUSTOMIZE_FONT},{element:"#acym__wysid__right__toolbar__settings__stylesheet__open",text:ACYM_JS_TXT.ACYM_INTRO_IMPORT_CSS}],t.setIntrojs("mail_editor_settings")},500)}))});